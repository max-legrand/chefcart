package webapp

import (
	"fmt"
	"main/webapp/middleware"
	Tokens "main/webapp/protobuf"
	"main/webapp/service"

	"github.com/dgrijalva/jwt-go"
	"google.golang.org/protobuf/proto"
)

// Prototest ...
func Prototest() {
	tokenbytes := "10 192 4 48 48 100 98 100 49 57 55 53 97 97 100 48 56 98 98 100 56 102 102 100 97 101 54 98 56 51 54 52 100 55 100 50 55 54 101 54 97 102 101 56 99 57 52 54 56 102 101 101 54 55 56 52 57 97 53 51 97 48 52 97 57 51 99 102 51 102 54 55 48 53 97 97 54 56 54 99 49 51 102 98 57 56 56 53 51 99 50 50 101 54 52 50 102 51 100 53 55 56 56 101 55 53 98 50 101 100 101 102 100 97 99 51 48 100 54 56 48 98 101 97 97 55 54 102 48 101 57 53 97 52 55 48 50 50 54 56 98 54 49 56 57 57 51 53 54 101 56 49 57 102 49 50 48 57 53 52 100 53 57 53 48 52 50 49 55 100 49 55 56 57 48 102 57 98 98 56 97 57 52 102 57 51 99 51 48 102 48 98 102 55 99 57 102 99 98 54 54 51 102 48 50 50 50 102 56 51 97 98 57 54 102 55 101 102 55 48 48 56 99 102 100 102 99 53 50 100 50 99 55 56 49 57 98 99 101 50 102 97 57 51 54 52 101 102 57 101 98 52 49 49 52 54 99 97 55 98 97 102 55 52 102 99 99 54 98 102 99 54 97 57 51 55 99 50 55 102 51 102 57 51 102 48 50 49 56 102 99 98 51 53 100 50 98 51 99 53 54 98 56 50 102 98 55 56 49 99 51 102 57 52 101 50 54 100 99 99 57 53 100 56 56 100 51 97 56 54 49 102 51 48 55 98 57 98 99 100 49 48 53 52 98 97 97 55 57 56 57 101 52 50 48 99 99 101 52 57 49 48 57 50 100 101 48 57 51 55 49 100 50 97 50 49 52 53 97 55 49 50 51 57 97 101 48 57 54 53 97 98 49 101 99 54 49 50 97 102 98 51 99 54 48 100 48 52 99 54 100 98 56 99 55 51 51 49 51 99 51 100 54 56 48 54 55 48 49 49 101 57 49 54 48 100 102 52 49 54 102 57 56 54 99 49 55 100 48 50 52 102 101 52 57 98 49 98 55 57 48 49 56 101 52 99 51 101 48 53 51 98 54 56 52 101 50 55 54 52 54 100 55 100 102 101 51 52 49 56 55 57 101 54 97 99 48 55 97 99 49 99 98 57 53 99 52 56 56 52 99 97 101 55 97 56 97 99 98 55 51 56 99 98 50 57 53 97 56 51 51 97 55 52 97 52 52 56 53 54 100 100 56 98 99 57 48 100 57 50 50 49 56 48 98 97 50 100 49 50 97 49 51 48 56 50 50 102 56 53 97 54 53 98 56 53 98 48 56"
	bytes := middleware.GenBytes(tokenbytes, " ")
	fmt.Println(bytes)
	prototoken := &Tokens.Token{}
	_ = proto.Unmarshal(bytes, prototoken)
	encTokenString := prototoken.Token
	fmt.Println(encTokenString)
	tokenString := middleware.Decrypt(encTokenString)
	fmt.Println(tokenString)
	token, _ := service.JWTAuthService().ValidateToken(tokenString)
	if token.Valid {
		claims := token.Claims.(jwt.MapClaims)
		fmt.Println(claims)
	} else {
		fmt.Println("INVALID TOKEN")
	}
}
